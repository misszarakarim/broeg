---
import Product from "../components/Products.astro";



const data = await fetch(
    "https://innnjxyaqyjceucizpxl.supabase.co/rest/v1/products", 
    {
    method:"GET",
    headers: {
        apikey: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imlubm5qeHlhcXlqY2V1Y2l6cHhsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzI1MzM3NDQsImV4cCI6MjA0ODEwOTc0NH0.j0GJ0nKDs09Qd39B_PxaBwDX69ZrOxYTNXPoTfzAWbI"
    },
}
).then((res) => res.json());







---
<!-- Category Buttons -->
<div>
    <button id="btn-krus" class="bg-pink-500">Krus</button>
    <button id="btn-tote" class="bg-blue-600">Tote</button>
    <button id="btn-show-all">Show All</button>
</div>

<!-- Product List -->
<section id="product-list">
    {data.map((product) => (
        <div 
            class="product" 
            data-kategori={product.kategori} 
            key={product.slug}
        >
            <Product data={product} />
        </div>
    ))}
</section>

<script client:load>
    document.addEventListener("DOMContentLoaded", () => {
        // Select all product elements
        const products = document.querySelectorAll('.product');

        // Function to filter products based on category
        const filterProducts = (kategori) => {
            console.log('Filtering category:', kategori); // Debugging
            products.forEach((product) => {
                if (kategori === '' || product.dataset.kategori === kategori) {
                    product.style.display = 'block';
                } else {
                    product.style.display = 'none';
                }
            });
        };

        // Attach event listeners to buttons
        document.getElementById('btn-krus').addEventListener('click', () => filterProducts('krus'));
        document.getElementById('btn-tote').addEventListener('click', () => filterProducts('tote'));
        document.getElementById('btn-show-all').addEventListener('click', () => filterProducts(''));
        
        console.log("Products initialized:", products); // Debugging
    });
</script>
